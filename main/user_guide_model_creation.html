<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Guide: How to create a FEMMT model &mdash; FEM Magnetics Toolbox 0.4.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> FEM Magnetics Toolbox
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html"><span class="sectnum">1</span> FEM Magnetics Toolbox (FEMMT)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#installation"><span class="sectnum">1.1</span> Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="intro.html#onelab-installation"><span class="sectnum">1.1.1</span> ONELAB installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#install-femmt"><span class="sectnum">1.1.2</span> Install FEMMT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#femmt-release-version-recommended"><span class="sectnum">1.1.2.1</span> FEMMT release version (recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#femmt-development-version-for-developers-only"><span class="sectnum">1.1.2.2</span> FEMMT development version (for developers only)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#examples"><span class="sectnum">1.2</span> Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="intro.html#basics"><span class="sectnum">1.2.1</span> Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#counting-arrow-system"><span class="sectnum">1.2.2</span> Counting arrow system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#gui-experimental"><span class="sectnum">1.3</span> GUI (Experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#femm-validation-for-developers-only"><span class="sectnum">1.4</span> FEMM Validation (for developers only)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#user-guide-how-to-create-a-femmt-model"><span class="sectnum">2</span> User Guide: How to create a FEMMT model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#working-directory"><span class="sectnum">2.1</span> Working directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#creating-a-core"><span class="sectnum">2.2</span> Creating a core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="intro.html#material-database"><span class="sectnum">2.2.1</span> Material database</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#adding-air-gaps-to-the-core"><span class="sectnum">2.3</span> Adding air gaps to the core</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#set-insulation-distances"><span class="sectnum">2.4</span> Set insulation distances</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#add-windings-to-the-winding-window"><span class="sectnum">2.5</span> Add windings to the winding window</a><ul>
<li class="toctree-l3"><a class="reference internal" href="intro.html#virtual-winding-windows"><span class="sectnum">2.5.1</span> Virtual Winding Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#winding-types-and-winding-schemes"><span class="sectnum">2.5.2</span> Winding types and winding schemes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#conductorarrangement"><span class="sectnum">2.5.2.1</span> ConductorArrangement</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#wrapparatype"><span class="sectnum">2.5.2.2</span> WrapParaType</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#add-conductors"><span class="sectnum">2.6</span> Add conductors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="intro.html#add-conductors-to-virtual-winding-windows"><span class="sectnum">2.6.1</span> Add conductors to virtual winding windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#create-model-and-start-simulation"><span class="sectnum">2.7</span> Create model and start simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#optional-create-thermal-simulation"><span class="sectnum">2.8</span> [Optional] Create thermal simulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#winding-types"><span class="sectnum">3</span> Winding types</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#femmt-class-and-function-documentation"><span class="sectnum">4</span> FEMMT class and function documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-magneticcomponent-class"><span class="sectnum">4.1</span> The <code class="docutils literal notranslate"><span class="pre">MagneticComponent</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-core-class"><span class="sectnum">4.2</span> The <code class="docutils literal notranslate"><span class="pre">Core</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-airgaps-class"><span class="sectnum">4.3</span> The <code class="docutils literal notranslate"><span class="pre">AirGaps</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-insulation-class"><span class="sectnum">4.4</span> The <code class="docutils literal notranslate"><span class="pre">Insulation</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-conductor-class"><span class="sectnum">4.5</span> The <code class="docutils literal notranslate"><span class="pre">Conductor</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-windingwindow-class"><span class="sectnum">4.6</span> The <code class="docutils literal notranslate"><span class="pre">WindingWindow</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-virtualwindingwindow-class"><span class="sectnum">4.7</span> The <code class="docutils literal notranslate"><span class="pre">VirtualWindingWindow</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-logparser-class"><span class="sectnum">4.8</span> The <code class="docutils literal notranslate"><span class="pre">LogParser</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#module-femmt.Enumerations"><span class="sectnum">4.9</span> <code class="docutils literal notranslate"><span class="pre">Enumerations</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#module-femmt.Functions"><span class="sectnum">4.10</span> Helper functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#developer-notes-for-femmt"><span class="sectnum">5</span> Developer Notes for FEMMT</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#winding-creation"><span class="sectnum">5.1</span> Winding creation</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FEM Magnetics Toolbox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>User Guide: How to create a FEMMT model</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/upb-lea/FEM_Magnetics_Toolbox/blob/main/sphinx/source/user_guide_model_creation.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="user-guide-how-to-create-a-femmt-model">
<h1>User Guide: How to create a FEMMT model<a class="headerlink" href="#user-guide-how-to-create-a-femmt-model" title="Permalink to this headline"></a></h1>
<p>This guide explains how a model can be created in femmt and provides all
the necessary information to work with femmt. Many examples for femmt
models can be found in the example folder.</p>
<section id="working-directory">
<h2>Working directory<a class="headerlink" href="#working-directory" title="Permalink to this headline"></a></h2>
<p>Every femmt model has a working directory which can be set when creating
an instance of the femmt base class called ‘MagneticComponent’. When
running the simulation many files will be created in the working
directory including the model, mesh and multiple result files. It also
contains the electro_magnetic_log.json which the most important
simulation results (e.g. losses, inductance, …).</p>
<p>Besides the working directory a MagneticComponent also needs a
ComponentType. Currently this can be ‘Inductor’, ‘Transformer’ or
‘IntegratedTransformer’.</p>
<p>This results to the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">femmt</span> <span class="k">as</span> <span class="nn">fmt</span>

<span class="n">geo</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">MagneticComponent</span><span class="p">(</span><span class="n">component_type</span><span class="o">=</span><span class="n">fmt</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">Inductor</span><span class="p">,</span> <span class="n">working_directory</span><span class="o">=</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Note about the silent-flag. In case of False, all outputs are printed in the terminal. In case of True, no command line outputs are shown. This simple feature significantly speeds up simulation time, especially for many automated simulations.</p>
</section>
<section id="creating-a-core">
<h2>Creating a core<a class="headerlink" href="#creating-a-core" title="Permalink to this headline"></a></h2>
<p>In general, only 2D rotationally symmetric geometries are represented in
FEMMT. Other core shapes must first be converted to a 2D rotationally
symmetric shape. The corresponding values for this (diameter core,
dimensions of the winding window) are taken from the data sheet.
Afterwards, a corresponding geometry is generated automatically.</p>
<p>The following graphics always show only a sectional view of the core
geometry.</p>
<a class="reference internal image-reference" href="_images/geometry_translated.png"><img alt="_images/geometry_translated.png" src="_images/geometry_translated.png" style="width: 800px;" /></a>
<p>After creating a MagneticComponent a core needs to be created. The core
needs spatial parameters as well as material parameters. The neccessary
spatial parameters are shown in the image below.</p>
<a class="reference internal image-reference" href="_images/geometry_core.png"><img alt="_images/geometry_core.png" src="_images/geometry_core.png" style="width: 800px;" /></a>
<p>Core spatial parameters can be entered manually but FEMMT provides a
database of different practical cores. This database can be accessed
using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">core_db</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">core</span><span class="o">-</span><span class="n">database</span><span class="p">()[</span><span class="s2">&quot;PQ 40/40&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now the core object can be created and added to the model (geo object)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">core</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Core</span><span class="p">(</span><span class="n">core_inner_diameter</span><span class="o">=</span><span class="n">core_db</span><span class="p">[</span><span class="s2">&quot;core_inner_diameter&quot;</span><span class="p">],</span> <span class="n">window_w</span><span class="o">=</span><span class="n">core_db</span><span class="p">[</span><span class="s2">&quot;window_w&quot;</span><span class="p">],</span> <span class="n">window_h</span><span class="o">=</span><span class="n">core_db</span><span class="p">[</span><span class="s2">&quot;window_h&quot;</span><span class="p">],</span> <span class="n">material</span><span class="o">=</span><span class="s2">&quot;N95&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">datasource</span><span class="o">=</span><span class="s2">&quot;manufacturer_datasheet&quot;</span><span class="p">)</span>
<span class="n">core</span><span class="o">.</span><span class="n">set_core</span><span class="p">(</span><span class="n">core</span><span class="p">)</span>
</pre></div>
</div>
<section id="material-database">
<h3>Material database<a class="headerlink" href="#material-database" title="Permalink to this headline"></a></h3>
<p>The <a class="reference external" href="https://github.com/upb-lea/materialdatabase">material database</a> was already introduced in the upper code example with the <cite>material=</cite> parameter. The temperature as well as the frequency are necessary to pick the corresponding data from the datasheet.</p>
</section>
</section>
<section id="adding-air-gaps-to-the-core">
<h2>Adding air gaps to the core<a class="headerlink" href="#adding-air-gaps-to-the-core" title="Permalink to this headline"></a></h2>
<p>In the next steps air gaps can be added. Currently it is only possible
to add air gaps in the center leg, there for the ‘AirGapLegPosition’ is
always ‘CenterLeg’. To set the vertical position for a air gap multiple
methods are available:</p>
<ul class="simple">
<li><p><strong>Center</strong>: The air gap will always be positioned in the center</p></li>
<li><p><strong>Percent</strong>: A value between 0 and 100 can be given. Where 0
represents the bottom end and 100 the top end of the winding window.</p></li>
<li><p><strong>Manually</strong>: The specific y coordinate nneeds to be entered
manually.</p></li>
</ul>
<a class="reference internal image-reference" href="_images/geometry_air_gap.png"><img alt="_images/geometry_air_gap.png" src="_images/geometry_air_gap.png" style="width: 800px;" /></a>
<p>Have a look at the following example on how to create an air gap object
and add it to the model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">air_gaps</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">AirGaps</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">fmt</span><span class="o">.</span><span class="n">AirGapMethod</span><span class="o">.</span><span class="n">Percent</span><span class="p">,</span> <span class="n">core</span><span class="o">=</span><span class="n">core</span><span class="p">)</span>
<span class="n">air_gaps</span><span class="o">.</span><span class="n">add_air_gap</span><span class="p">(</span><span class="n">leg_position</span><span class="o">=</span><span class="n">fmt</span><span class="o">.</span><span class="n">AirGapLegPosition</span><span class="o">.</span><span class="n">CenterLeg</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span> <span class="n">position_value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">geo</span><span class="o">.</span><span class="n">set_air_gaps</span><span class="p">(</span><span class="n">air_gaps</span><span class="p">)</span>
</pre></div>
</div>
<p>Adding an air_gap object is not necessary. If no air gap is needed,
don’t add the air gap object to the model.</p>
</section>
<section id="set-insulation-distances">
<h2>Set insulation distances<a class="headerlink" href="#set-insulation-distances" title="Permalink to this headline"></a></h2>
<p>There are multiple insulations implemented in femmt. Some of them are
created as rectangles in the model, some are just adding an offset to
the windings.</p>
<p>Core insulations are the insulations which are created as rectangles in
the model. 4 core insulations will be added: top, left, bottom, right.
The distance of those values can be set with the ‘add_core_insulations’
function.</p>
<p>Furthermore there are offset insulations between each turn in the same
winding, a distance between 2 windings in one virtual winding window and
a distance between each virtual winding window. The first two are set
using the ‘add_winding_insulations’ functions, the last one when
creating such a virtual winding window (vww).</p>
<p>The function ‘add_winding_insulations’ therefore needs multiple
parameters:</p>
<ul class="simple">
<li><p>The first parameter is a list called <strong>inner_windings</strong>, where the
list index corresponds to the number of the winding (0: Primary, 1:
Secondary, …).</p></li>
<li><p>The second parameter is the distance between two virtual winding
windows, this is called <strong>virtual_winding_window_insulation</strong>.</p></li>
</ul>
<a class="reference internal image-reference" href="_images/geometry_insulation.png"><img alt="_images/geometry_insulation.png" src="_images/geometry_insulation.png" style="width: 800px;" /></a>
<p>This is how to create an insulation object and add certain insulations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insulation</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Insulation</span><span class="p">()</span>
<span class="n">insulation</span><span class="o">.</span><span class="n">add_core_insulation</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">insulation</span><span class="o">.</span><span class="n">add_winding_insulation</span><span class="p">([</span><span class="mf">0.0005</span><span class="p">],</span> <span class="mf">0.0001</span><span class="p">)</span>
<span class="n">geo</span><span class="o">.</span><span class="n">set_insulation</span><span class="p">(</span><span class="n">insulation</span><span class="p">)</span>
</pre></div>
</div>
<p>The spatial parameters for the insulation, as well as for every other
function in FEMMT, are always in SI-Units, in this case metres.</p>
</section>
<section id="add-windings-to-the-winding-window">
<h2>Add windings to the winding window<a class="headerlink" href="#add-windings-to-the-winding-window" title="Permalink to this headline"></a></h2>
<p>In order to understand the way winding windows work in femmt, the
concept of virtual winding windows must be explained:</p>
<section id="virtual-winding-windows">
<h3>Virtual Winding Windows<a class="headerlink" href="#virtual-winding-windows" title="Permalink to this headline"></a></h3>
<p>For every femmt model there is always one winding window, which is a 2D
representation of the 3D rotated winding window. This winding window can
be split into multiple virtual winding windows which are used to draw
the conductors. There are multiple ways to split a winding window:</p>
<ul class="simple">
<li><p><strong>NoSplit</strong>: Only 1 virtual winding window will be returned and it
has the same size as the real winding window.</p></li>
<li><p><strong>HorizontalSplit</strong>: 2 virtual winding windows will be returned, one
for the top and one for the bottom part. The height of the splitting
line can be set using a horizontal_split_factor (value between 0 and
1)</p></li>
<li><p><strong>VerticalSplit</strong>: 2 virtual winding windows will be returned, one
for the left and one for the right part. The radius (x-coordinate) of
the splitting line can be set using a vertical_split_factor (value
between 0 and 1)</p></li>
<li><p><strong>HorizontalAndVerticalSplit</strong>: 4 virtual winding windows are
returned. One for each corner (in the following order): top_left,
top_right, bottom_left, bottom_right. In this case the horizontal and
vertical split factors can be used to set the sizes of each grid
cell.</p></li>
</ul>
<a class="reference internal image-reference" href="_images/geometry_winding_windows.png"><img alt="_images/geometry_winding_windows.png" src="_images/geometry_winding_windows.png" style="width: 800px;" /></a>
<p>In addition to that 2 virtual winding windows can be combined to one
(this is not possible for (top_left, bottom_right) or (top_right,
bottom_left) combinations). This is done using the combine_vww()
function of the WindingWindow class.</p>
<p>Each virtual winding window can be filled with either one single winding
or one interleaved winding.</p>
<p>A winding window with only one virtual winding window can be craeted
like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">winding_window</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">WindingWindow</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="n">insulation</span><span class="p">)</span>
<span class="n">vww</span> <span class="o">=</span> <span class="n">winding_window</span><span class="o">.</span><span class="n">split_window</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">WindingWindowSplit</span><span class="o">.</span><span class="n">NoSplit</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="winding-types-and-winding-schemes">
<h3>Winding types and winding schemes<a class="headerlink" href="#winding-types-and-winding-schemes" title="Permalink to this headline"></a></h3>
<p>The following table gives an overview of the different winding types,
winding schemes and conductor arrangements:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 11%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>WindingType</strong></p></th>
<th class="head"><p><strong>ConductorType</strong></p></th>
<th class="head"><p><strong>WindingScheme</strong></p></th>
<th class="head"><p><strong>ConductorArrangement</strong></p></th>
<th class="head"><p><strong>WrapParaType</strong></p></th>
<th class="head"><p><strong>status</strong></p></th>
<th class="head"><p><strong>description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Interleaved</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>Always needs 2 conductors</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>RoundSolid, RoundLitz</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>Bifilar</p></td>
<td></td>
<td></td>
<td><p>not implemented</p></td>
<td><p>TODO</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>VerticalAlternating</p></td>
<td></td>
<td></td>
<td><p>not implemented</p></td>
<td><p>primary and secondary winding are interleaved vertically (rows)</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>HorizontalAlternating</p></td>
<td></td>
<td></td>
<td><p>implemented</p></td>
<td><p>primary and secondary winding are interleaved horizontally (cols)</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>VerticalStacked</p></td>
<td></td>
<td></td>
<td><p>implemented</p></td>
<td><p>primary winding is drawn bottom to top, seoncdary winmding is drawn top to bottom</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td><p>Square</p></td>
<td></td>
<td><p>“</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td><p>Hexagonal</p></td>
<td></td>
<td><p>“</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>RectangularSolid</p></td>
<td></td>
<td></td>
<td></td>
<td><p>not implemented</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Single</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>Always needs 1 conductor</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>RoundSolid, RoundLitz</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>None</p></td>
<td></td>
<td></td>
<td><p>implemented</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td><p>Square</p></td>
<td></td>
<td><p>“</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td><p>Square full width</p></td>
<td></td>
<td><p>“</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td><p>Hexagonal</p></td>
<td></td>
<td><p>“</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>RectangularSolid</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>Full</p></td>
<td></td>
<td></td>
<td><p>implemented</p></td>
<td><p>whole virtual winding window contains is filled with one turn</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>FoilHorizontal (stacked)</p></td>
<td></td>
<td></td>
<td><p>implemented</p></td>
<td><p>foils are very long (x-axis) and drawn along y-axis</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>Square full width</p></td>
<td></td>
<td></td>
<td><p>not implemented</p></td>
<td><p>foils are drawn along x-axis first and then along y-axis</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>FoilVertical</p></td>
<td></td>
<td></td>
<td><p>implemented</p></td>
<td><p>foils are very tall (y-axis) and drawn along x-axis</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td></td>
<td><p>Fixed Thickness</p></td>
<td><p>“</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
<td><p>Interpolate</p></td>
<td><p>“</p></td>
<td></td>
</tr>
</tbody>
</table>
<section id="conductorarrangement">
<h4>ConductorArrangement<a class="headerlink" href="#conductorarrangement" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><strong>Square</strong>: conductors are set in next to each other in a grid</p></li>
<li><p><strong>Hexagonal</strong>: similar to square but in this case the conductors
frpmo the next column slips in the free space between two conductors
from the first column</p></li>
<li><p><strong>Square full width</strong>: conducors are first drawn along x-axis and
then y-axis</p></li>
</ul>
</section>
<section id="wrapparatype">
<h4>WrapParaType<a class="headerlink" href="#wrapparatype" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><strong>Fixed thickness</strong>: TODO</p></li>
<li><p><strong>Interpolate</strong>: TODO</p></li>
</ul>
<p>Images for the possible winding types can be found <a class="reference internal" href="intro.html#winding-types"><span class="std std-ref">here</span></a>.</p>
</section>
</section>
</section>
<section id="add-conductors">
<h2>Add conductors<a class="headerlink" href="#add-conductors" title="Permalink to this headline"></a></h2>
<p>When creating an instance of the class Conductor a winding number and a
conductivity needs to be given:</p>
<p>The winding number represents the index of the winding (e.g. primary-&gt;1,
secondary-&gt;2, tertiary-&gt;3). As an example: When starting a simulation on
a transformer a current needs to be given, this is done in a list. The
first index of the current’s list will be set to the winding with the
lowest winding number, the second index of the list to the winding with
the second lowest winding number and so on.</p>
<p>The conductivity can be set using the Conductivity enum where one of two
possible materials need to be selected:</p>
<ul class="simple">
<li><p><strong>Copper</strong></p></li>
<li><p><strong>Aluminium</strong></p></li>
</ul>
<p>After creating an conductor object it is necessary to add a conductor to
it. As already shown in the winding types table 3 different conducors
can be set:</p>
<ul class="simple">
<li><p><strong>RoundSolid</strong></p></li>
<li><p><strong>RoundLitz</strong></p></li>
<li><p><strong>RectangularSolid</strong></p></li>
</ul>
<p>To create a conductor have a look at the following code example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">winding1</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Conductor</span><span class="p">(</span><span class="n">winding_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">conductivity</span><span class="o">=</span><span class="n">fmt</span><span class="o">.</span><span class="n">Conductivity</span><span class="o">.</span><span class="n">Copper</span><span class="p">)</span>
<span class="n">winding1</span><span class="o">.</span><span class="n">set_solid_round_conductor</span><span class="p">(</span><span class="n">conductor_radius</span><span class="o">=</span><span class="mf">0.0011</span><span class="p">,</span> <span class="n">conductor_arrangement</span><span class="o">=</span><span class="n">fmt</span><span class="o">.</span><span class="n">ConductorArrangement</span><span class="o">.</span><span class="n">Square</span><span class="p">)</span>
</pre></div>
</div>
<section id="add-conductors-to-virtual-winding-windows">
<h3>Add conductors to virtual winding windows<a class="headerlink" href="#add-conductors-to-virtual-winding-windows" title="Permalink to this headline"></a></h3>
<p>Now the conductors need to be added to the virtual winding windows with
the corresponding winding type and winding scheme. In this case the
set_winding() or set_interleaved_winding() function needs to be called.
In the set_interleaved_winding() function an insulation distance can
also be set. This value represents the distance between conductors from
the primary and secondary side.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vww</span><span class="o">.</span><span class="n">set_winding</span><span class="p">(</span><span class="n">conductor</span><span class="o">=</span><span class="n">winding1</span><span class="p">,</span> <span class="n">turns</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">winding_scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>If you have a look at the winding types and windng schemes table a
winding scheme is not needed when creating a round solid conductor in
single winding. Therefore the value is set to None.</p>
<p>Now before simulating the winding window needs to be added to the model
as well:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">geo</span><span class="o">.</span><span class="n">set_winding_window</span><span class="p">(</span><span class="n">winding_window</span><span class="o">=</span><span class="n">winding_window</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="create-model-and-start-simulation">
<h2>Create model and start simulation<a class="headerlink" href="#create-model-and-start-simulation" title="Permalink to this headline"></a></h2>
<p>After every needed component is added to the model the model can be
created. This is done using the create_model() function. The frequency
is needed there because of the mesh which is adapted according to the
skin depth. In addition to that a boolean can be given to show the model
after creation (in gmsh).</p>
<p>The last step is to run a simulation using single_simulation(), which
needs the frequency, currents (and phase if transformer is set) as
parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">geo</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">visualize_before</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_png</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">geo</span><span class="o">.</span><span class="n">single_simulation</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">current</span><span class="o">=</span><span class="p">[</span><span class="mf">4.5</span><span class="p">],</span> <span class="n">show_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The results should look like this:</p>
</section>
<section id="optional-create-thermal-simulation">
<h2>[Optional] Create thermal simulation<a class="headerlink" href="#optional-create-thermal-simulation" title="Permalink to this headline"></a></h2>
<p>After running the electromagnetic simulation it is possible to use the
simulation results and the created model and start a thermal simulation.
The thermal simulation will add a case surrounding the previous created
model. At the edge of this case the boundary condition is applied and
the thermal conductivity as well as the dimensions of the case can be
choosen freely. This case is split into 5 parts: top, top right, right,
bot right, bot. For each region a different thermal conductivity and
boundary condition can be set. In order to run thermal a thermal
simulation different values are needed:</p>
<ul class="simple">
<li><p>thermal conductivity dict: A dictionary containing thermal
conductivities for each region. The regions are: air, core, winding,
air_gaps, insulation, case (which is split in top, top_right, right,
bot_right, bot</p></li>
<li><p>case gap values: Set the size of the surrounding case</p></li>
<li><p>boundary temperatures dict: The temperatures which will be applied at
the edge of the case (dirichlet boundary condition)</p></li>
<li><p>boundary flags: By disabling a specific boundary its condition can be
set to a neumann boundary condition ignoring the temperature
parameter</p></li>
</ul>
<a class="reference internal image-reference" href="_images/geometry_thermal.png"><img alt="_images/geometry_thermal.png" src="_images/geometry_thermal.png" style="width: 800px;" /></a>
<p>Have a look at this example on how to set the parameters since the
dictionary keywords are important to write correctly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">thermal_conductivity_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;air&quot;</span><span class="p">:</span> <span class="mf">0.0263</span><span class="p">,</span>
        <span class="s2">&quot;case&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="mf">0.122</span><span class="p">,</span>
            <span class="s2">&quot;top_right&quot;</span><span class="p">:</span> <span class="mf">0.122</span><span class="p">,</span>
            <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mf">0.122</span><span class="p">,</span>
            <span class="s2">&quot;bot_right&quot;</span><span class="p">:</span> <span class="mf">0.122</span><span class="p">,</span>
            <span class="s2">&quot;bot&quot;</span><span class="p">:</span> <span class="mf">0.122</span>
        <span class="p">},</span>
        <span class="s2">&quot;core&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;winding&quot;</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
        <span class="s2">&quot;air_gaps&quot;</span><span class="p">:</span> <span class="mi">180</span><span class="p">,</span>
        <span class="s2">&quot;insulation&quot;</span><span class="p">:</span> <span class="mf">0.42</span>
<span class="p">}</span>

<span class="n">case_gap_top</span> <span class="o">=</span> <span class="mf">0.002</span>
<span class="n">case_gap_right</span> <span class="o">=</span> <span class="mf">0.0025</span>
<span class="n">case_gap_bot</span> <span class="o">=</span> <span class="mf">0.002</span>

<span class="n">boundary_temperatures</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;value_boundary_top&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;value_boundary_top_right&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;value_boundary_right_top&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;value_boundary_right&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;value_boundary_right_bottom&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;value_boundary_bottom_right&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;value_boundary_bottom&quot;</span><span class="p">:</span> <span class="mi">20</span>
<span class="p">}</span>

<span class="n">boundary_flags</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;flag_boundary_top&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;flag_boundary_top_right&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;flag_boundary_right_top&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;flag_boundary_right&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;flag_boundary_right_bottom&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;flag_boundary_bottom_right&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;flag_boundary_bottom&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the boundary_flags dictionary 2 flags are set to 0 which means there
will be a neumann boundary applied. Please have a look at the picture
above which shows the current selected boundaries.</p>
<p>In the following table a possible set of thermal conductivities can be
found:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 53%" />
<col style="width: 47%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Material</strong></p></td>
<td><p><strong>Thermal conductivity</strong></p></td>
</tr>
<tr class="row-even"><td><p>air (background)</p></td>
<td><p>0.0263</p></td>
</tr>
<tr class="row-odd"><td><p>epoxy resign (used in case)</p></td>
<td><p>1.54</p></td>
</tr>
<tr class="row-even"><td><p>ferrite (core)</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>copper (winding)</p></td>
<td><p>400</p></td>
</tr>
<tr class="row-even"><td><p>aluminiumnitride (air gaps)</p></td>
<td><p>180</p></td>
</tr>
<tr class="row-odd"><td><p>polyethylen (insulation)</p></td>
<td><p>0.42</p></td>
</tr>
</tbody>
</table>
<p>The thermal simulation will solve the stationary heat equation and since
no convection is considered every material is assumed to be solid. Now
the simulation can be run:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">geo</span><span class="o">.</span><span class="n">thermal_simulation</span><span class="p">(</span><span class="n">thermal_conductivity_dict</span><span class="p">,</span> <span class="n">boundary_temperatures</span><span class="p">,</span> <span class="n">boundary_flags</span><span class="p">,</span> <span class="n">case_gap_top</span><span class="p">,</span> <span class="n">case_gap_right</span><span class="p">,</span> <span class="n">case_gap_bot</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The following image shows the simulation results:</p>
<a class="reference internal image-reference" href="_images/user_guide_example_thermal_simulation.png"><img alt="_images/user_guide_example_thermal_simulation.png" src="_images/user_guide_example_thermal_simulation.png" style="width: 350px;" /></a>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, LEA, Paderborn University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>